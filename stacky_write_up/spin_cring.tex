%%%%%%%%%%%%%%%%%%%%%
%   AMS packages    %
%%%%%%%%%%%%%%%%%%%%%
\documentclass{amsart}

\usepackage{amsmath}
\usepackage{amsxtra}
\usepackage{amscd}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{eucal}
\usepackage[all]{xy}
\usepackage{graphicx}
\usepackage{tikz-cd}
\usepackage{mathrsfs}
\usepackage{subfiles}
\usepackage{mathpazo}
\usepackage{euler}
\usepackage{hyperref}
\usepackage{color}

\usepackage[colorinlistoftodos, textsize=tiny]{todonotes}
\def\listtodoname{List of Todos}
\def\listoftodos{\@starttoc{tdo}\listtodoname}

%\addtolength{\oddsidemargin}{-.5 in}
	%\addtolength{\evensidemargin}{-.4 in}
	%\addtolength{\textwidth}{1 in}
%
	%\addtolength{\topmargin}{0 in}
	%\addtolength{\textheight}{0 in}

\RequirePackage{color}
\definecolor{myred}{rgb}{0.75,0,0}
\definecolor{mygreen}{rgb}{0,0.5,0}
\definecolor{myblue}{rgb}{0,0,0.65}

\usepackage{hyperref}
  \hypersetup{colorlinks=true,citecolor=blue}

\usepackage{tikz}
\usetikzlibrary{matrix,arrows,decorations.pathmorphing}

%%%%%%%%%%%%%%%%%%%%%%% amsthm theorem styles %%%%%%%%%%%%%%%%%%%%%%%

\theoremstyle{plain}
  \newtheorem{thm}{Theorem}[section]
  \newtheorem{prop}[thm]{Proposition}
  \newtheorem{lem}[thm]{Lemma}
  \newtheorem{cor}[thm]{Corollary}
	\newtheorem{claim}[thm]{Claim}
	\newtheorem{question}[thm]{Question}
	
\theoremstyle{definition}
  \newtheorem{defn}[thm]{Definition}
  \newtheorem{example}[thm]{Example}
  \newtheorem{exer}[thm]{Exercise}
  \newtheorem{ctexample}[thm]{Counterexample}
  \newtheorem{convention}[thm]{Convention}
	\newtheorem{conjecture}[thm]{Conjecture}
	
\theoremstyle{remark}
	\newtheorem{rem}[thm]{Remark}
  \newtheorem{note}[thm]{Notation}
  \newtheorem*{note*}{Notation}
  \newtheorem{case}{Case}
	
\numberwithin{equation}{section}

%%%%%%%%%%%%%%%%%%%%%%%%% custom commands %%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand\nc{\newcommand}
\nc\on{\operatorname}
\nc\renc{\renewcommand}
\newcommand\ssec{\subsection}
\newcommand\sssec{\subsubsection}
\newcommand\bO{{\mathbf O}}
\newcommand\CC{{\mathcal C}}
\newcommand\BN{{\mathbb N}}
\newcommand\BC{{\mathbb C}}
\newcommand\BF{{\mathbb F}}
\newcommand\BR{{\mathbb R}}
\newcommand\BQ{{\mathbb Q}}
\newcommand\BP{{\mathbb P}}
\newcommand\BBZ{{\mathbb Z}}
\newcommand\uR{\underline{R}}
\newcommand\uZ{\underline{\BBZ}}
\newcommand\CF{{\mathcal F}}
\newcommand\uCF{\underline{{\mathcal F}}}
\newcommand\BZ{{\mathbb Z}}
\newcommand\BA{{\mathbb A}}
\newcommand\fa{{\mathfrak a}}
\newcommand\fp{{\mathfrak p}}
\newcommand\fq{{\mathfrak q}}
\newcommand\fm{{\mathfrak m}}
\newcommand\so{{\mathscr O}}
\newcommand\sg{{\mathscr G}}
\newcommand \sx{\mathscr X}

\newcommand\scm{{\mathscr M}}
\newcommand\scn{{\mathscr N}}
\newcommand\scf{{\mathscr F}}
\newcommand\scg{{\mathscr G}}
\newcommand\sco{{\mathscr O}}
\newcommand\sch{{\mathscr H}}
\newcommand\scl{{\mathscr L}}
\newcommand\sci{{\mathscr I}}

\newcommand{\id}{\mathrm{id}}
\newcommand\im{\text{im }}
\newcommand\coker{\text{coker}}
\newcommand \spec{\text{Spec }}
\newcommand \proj{\text{Proj }}
\newcommand \rspec{\textit{Spec }}
\newcommand \rproj{\textit{Proj }}
\newcommand{\gal}{\mathrm{Gal}}

\newcommand \trdeg{\text{tr. deg }}
\newcommand \codim{\text{codim}}
\newcommand \rk{\text{rk }}
\newcommand \di{\text{div }}
\newcommand \depth{\text{depth }}
\DeclareMathOperator{\ord}{ord}

\newcommand \subhalf[1]{\frac{{#1} - 1}{2{#1}}}
\newcommand{\se}[1]{\section*{Problem #1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% title %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\title{Spin canonical divisors of log stacky curves}

\author{Aaron Landesman}
\address[Aaron Landesman]{Department of Mathematics, Harvard University}
\email{aaronlandesman@college.harvard.edu}

\author{Peter Ruhm}
\address[Peter Ruhm]{Department of Mathematics, Stanford University}
\email{pruhm@stanford.edu}

\author{Robin Zhang}
\address[Robin Zhang]{Department of Mathematics, Stanford University}
\email{robinz16@stanford.edu}

\date{\today}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% document %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\begin{abstract}
  Arithmetic geometry group at the Emory University Number Theory
	REU.
\end{abstract}

\maketitle

\section{Introduction}
This is our project.
Example, O'Dorney's paper \cite{dorney:canonical}.
We consider divisors of the form $D = \sum_{i = 1}^{r} \subhalf{e_i}$.

\subsection{Main Results}
These are our results.
\begin{thm}
\label{thm:g_0_generators_relations}
Let $(\sx,L)$ is a spin curve, so that $\sx$ has signature $\sigma = (0;e_1,\ldots, e_r;0)$, then $R(\sx,L)$ is generated in degree at most $e = \max(5,e_1,\ldots, e_r)$ with relations in degree at most $2e$, so long as $\sigma$ does not lie in a finite list of exceptions. \todo{Rewrite this to be more precise}
\end{thm}
\begin{proof}

\end{proof}


\section{Background}
Here are some definitions.
Look at Spencer-Kodaira \cite{kodaira:complex-manifolds}.

\section{Effective Genus Zero Spin Divisors}
\label{sec:g_0_effective}
Let us consider $\delta \geq 2$.

\section{Non-effective Genus Zero Spin Divisors}
\label{sec:g_0_non_effective}

In this section, we will prove that if $(\sx,L)$ is a spin curve, so that $\sx$ has signature $\sigma = (0;e_1,\ldots, e_r;0)$, then $R(\sx,L)$ is generated in degree at most $e = \max(5,e_1,\ldots, e_r)$ with relations in degree at most $2e$, so long as $\sigma$ does not lie in a finite list of exceptions. This is proven in Subsection ~\ref{ssec:g_0_conclusion}. The proof is a rather involved induction. In Subsections ~\ref{ssec:g_0_ram_pts}, ~\ref{ssec:g_0_ram_orders} we prove inductive theorems, and in Subsection ~\ref{ssec:g_0_base} we check the base cases of the induction. Finally, in Subsection ~\ref{ssec:g_0_exceptional} we list out the exceptional cases.

\ssec{Saturation}
\label{ssec:g_0_saturation}

\ssec{Inductive Theorem: Increasing the Number of Ramified Points}
\label{ssec:g_0_ram_pts}


\begin{lem}
\label{sat_three_induction}
Let $\sx \rightarrow \sx'$ be a birational map of tame, separably rooted  log stacky curves $R \subset R'$ be the corresponding inclusion of canonical rings. Let $R_{D'} = R' = k[x]/I'$ satisfy $sat(Eff(D')) = 3.$ Let $D = \subhalf {e_i}$. There are generators $y_3,y_4,y_5$ of $R_{D+D'}= R$ over $R'$ so that $y_i$ lies in degree $i$ and has a pole of order $1$. \todo{Include the order}
Let $x_3,x_4,x_5$ be generators of $k[x]$ lying in degrees 3,4,5 respectively. \todo{Make sure to state some requirement on the ordering of the $x_i$, analogously to 8.4.1, but I don't see why this is important.} Then, letting $x_j$ range over all $x$ variables
\begin{align*}
	in_\prec(I) = in_\prec(I')k[x,y_3,\ldots, y_e,z_4,z_5] + \\
	\langle y_i y_j \mid 1 \leq i < j-3 \leq e \rangle +\\
	\langle y_i x_j \mid i > 3 \rangle +\\
	\langle z_i y_j \mid j > 3 \rangle  +\\
	\langle z_i x_j \mid 4 \leq i \leq 5\rangle + \\
	\langle z_iz_k \mid 4 \leq i \leq j \leq 5 \rangle 
\end{align*}

\end{lem}
\begin{proof}
We can see the following is a $k$ basis for $R$ over $R'$:
\begin{align*}
	\langle y_i^ay_{i+2}^b \mid a \geq 0,b\geq 0, 3 \leq i \leq e-2\rangle +\\
	\langle y_3^ax_3^b x_4^\epsilon x_5^{\epsilon'} \mid a \geq 0, b \geq 0(\epsilon,\epsilon') \in \{(0,0),(0,1),(1,0)\} \rangle +\\
	\langle y_3^az_4,y_3^bz_5 \mid a \geq 0, b \geq 0 \rangle\\
\end{align*}
Note that this is precisely the monomials which are not divisible by those in the claimed initial ideal. By the trick of projecting to the pole order by degree 2-dim lattice, we see this is a $k$ basis. We also see that $z_i,y_j$ are generators. \todo{Note that $z_5$ is chosen specially, and is not generic}

It only remains to show the initial ideal is as claimed. Note that once we show this, we will automatically obtain minimality, using the regrading to degree 1 trick.

To show this is the initial ideal, it suffices to exhibit such relations with the claimed leading terms in the initial ideal. Indeed, we will now give only leading order terms. We have relations starting with
\begin{align*}
	y_iy_j - y_{i-1}y_{j+1} + \cdots &\mid i < j-1 \\
	y_ix_4 - y_{i-2}y_3x_3 + \cdots & \mid i > 3\\
	y_ix_5 - y_{i-2}y_3x_4 + \cdots & \mid i > 3\\
	y_ix_3-y_3^3y_{i-6} + \cdots &\mid i > 7\\
	y_7x_3-y_3^2 z_4 + \cdots \\
	y_5x_3 - y_3z_5 + \cdots \\
	z_4^2 - y_3 z_5 + \cdots \\
	z_4z_5 - y_3^2x_3 + \cdots \\
 	z_5^2 - y_3^2 x_4 + \cdots \\
 	z_4 y_i - y_3^2 y_{i-2} + \cdots &\mid i > 3 \\
 	z_5 y_i - y_3y_{i-2}z_4 + \cdots &\mid i > 3 \\
 	z_i x_j - y_3 z_{i+j-3} + \cdots &\mid i+j \leq 8 \\
 	z_i x_j - y_3x_3x_{i+j-6} + \cdots &\mid i+j > 8
\end{align*}
\end{proof}
\todo{Something is a little fishy with this order, it seems something like: first grade by degree, then try to decrease the highest y, if you cant, try to decrease the highest z, possibly replace $z_5$ by $z_5+Cy_5$ to generic element?}


\ssec{Inductive theorem: Increasing the Ramification Orders}
\label{ssec:g_0_ram_orders}
In this section, we aim to prove the inductive theorem, Theorem ~\ref{thm:ramification_order_induction}. Under fairly general conditions, this theorem will allow us to show that if Theorem ~\ref{thm:ramification_order_induction} holds for a curve with signature $(0;e_1',\ldots, e_r';0)$ then it also holds for a curve with signature $(0;e_1,\ldots, e_r;0)$ with $e_i' - e_i \in \{0,2\}$.

\begin{defn}
\label{defn:admissible}
Let $(\sx',L'),(\sx,L)$ be tame, separably rooted log stacky spin curves, both ramified over ramified at $Q_1,\ldots, Q_r$. Suppose there is a birational map $\sx \rightarrow \sx'$, and let $J \subset \{1,
\ldots, r\}$. Suppose $e_i'+ 2\chi_J(i) = e_i$ where
$$
\chi_J(i) = \begin{cases}
	1, &\text{ if }i \in J\\
	0, &\text{ otherwise. } 
\end{cases}$$
Let $R'$ be the canonical ring associated to $\sx'$. Say $(\sx',J)$, {\bf admissible} if the following three conditions hold.
\begin{enumerate}
	\item[(Ad-i)] Suppose for all $i \in J$, there exists $y_{i,e_i'} \in R'$ so that $R'$ admits a presentation
\begin{align*}
	R' \cong \left( k[x] \otimes k[y_{i,e_i'}]_{i \in J} \right)/I'
\end{align*}
so that for all $i \in J$ we have $\deg y_{e_i'} = e_i'$ and $-ord_{Q_i}(y_{i,e_i'}) = \frac{e_i'-1}{2}$.
\item[(Ad-ii)] For all $i \in J$ and $z \neq y_{i,e_i'}$ a generator of $R'$ we have
\begin{align*}
	\frac{- ord_{Q_i}(z)}{\deg z} < \subhalf {e_i'}.
\end{align*}
\item[(Ad-iii)] For all $i \in J$ we have
\begin{align*}
	\deg \lfloor e_i L \rfloor \geq \# S(i)
\end{align*}
where
\begin{align*}
	\eta(i) = \{j \in J : j \neq i \text{ and }e_j' \mid e_i\}
\end{align*}
\end{enumerate}
\end{defn}

\begin{lem}
\label{lem:admissible_inequality}
Condition (Ad-ii) of Definition ~\ref{defn:admissible} implies the stronger condition that
\begin{align*}
	-\ord_{Q_i}(z) \leq \deg(z) \subhalf{e_i'}-\frac{1}{e_i'}
\end{align*}
\end{lem}
\begin{proof}
We know by (Ad-ii) that
\begin{align*}
	-\ord_{Q_i}(z) < \deg(z) \subhalf{e_i'}
\end{align*}
If we write $\frac{\alpha}{\beta} = \deg(z) \frac{e_i'-1}{2e_i'}$ as a fraction in lowest terms, then we see $\beta \mid e_i'$ since $e_i'-1$ is even. Therefore, since $-\ord_{Q_i}(z)$ is an integer, we must have
\begin{align*}
	-\ord_{Q_i}(z) \leq \deg(z) \subhalf{e_i'}- \frac{1}{\beta} \leq \deg(z) \subhalf{e_i'}- \frac{1}{e_i'}.
\end{align*}
\end{proof}

\begin{thm}
\label{thm:ramification_order_induction}
Suppose $(\sx',L')$ is a tame separably rooted log stacky spin curve is admissible with a generators $y_{i,e_i'} \in R' = R_{L'}$ as in (Ad-i) of Definition ~\ref{defn:admissible}. Then the following are true:
\begin{enumerate}
	\item[(a)] For all $i \in J$, there exists $y_{i,e_i} \in H^0(\sx, e_i(K_\sx))$ so that
	\begin{align*}
	-ord_{Q_i}(y_{i,e_i}) = \frac{e_i-1}{2}
\end{align*}
and
\begin{align*}
	\frac{-\ord_{Q_j}(y_{i,e_i'})}{y_{i,e_i}} \leq \subhalf{e_j'}-\frac{1}{\deg(y_{i,e_i'})e_j'}
\end{align*}
for all $j \in J$ with $j \neq i$.
\item[(b)] The elements $y_{i,e_i'}^ay_{i,e_i}^b,$ with $a \geq 0, b > 0$ span $R$ over $R'$ and the elements $y_{i,e_i}$ minimally generate $R$ over $R'$.
\item[(c)] Equip $k[y] = k[y_{i,e_i}]_{i \in J}$ and $k[x]$ with any graded monomial order and $k[y,x] = k[y] \otimes k[x]$ with block order. Let $R = k[y,x]/I.$ Then,
\begin{align*}
	in_\prec(I) = in_\prec(I')k[x,y] + \langle y_{i,e_i}z \mid z \neq y_{i,e_i},y_{i,e_i'} \rangle 
\end{align*}
	as $z$ ranges over all generators of $R$.
	\item[(d)] Suppose $in_\prec(I')$ is minimally generated by quadratics and that for all $i \in J$, we have $e_i > \deg z$ for any generator $z$ of $R'.$ Then any set of minimal generators for $I'$ together with any set of relations as in the previous part \todo{reference previous part as part c} minimally generate $I$.
	\item[(e)] For any $W \subset J,$ the set $(\sx,W)$ is admissible.
\end{enumerate}
\end{thm}
\begin{proof}
Let $(\sx,L)$ and $(\sx',L')$ be the two log stacky spin curves in question, with coarse spaces $X = X'$. Define
\begin{align*}
	S(i) = \{j \in J : j \neq i \text{ and }e_j' \mid e_i\}
\end{align*}
Define
\begin{align*}
	E_i = \sum_{j \in S(i)}^{}Q_j
\end{align*}
Note that
\begin{align*}
	\lfloor e_i L' \rfloor + Q_i \leq \lfloor e_i L \rfloor 
\end{align*}
and so we obtain an inclusion
\begin{align*}
	H^0(\sx',e_iL'-E_i + Q_j) \rightarrow H^0(\sx,e_iL - E_i) \subset H^0(\sx,e_iL).
\end{align*}
The assumption (Ad-iii) implies
\begin{align*}
	\deg \left( e_i L' - E_i \right) \geq 0
\end{align*}
implying that $H^0(\sx',e_iL'-E_i + Q_i)$ is base point free by Riemann Roch, and so a general element
\begin{align*}
	y_{i,e_i} \in H^0(\sx',e_iL'-E_i + Q_i)
\end{align*}
satisfies
\begin{align*}
	-\ord_{Q_i}(y_{i,e_i}) = \lfloor e_i \subhalf {e_i'} \rfloor +1 = \frac{e_i - 1}{2}
\end{align*}
Therefore, $y_{i,e_i}$ satisfies the first part of the claim of $(a)$.

We next show $y_{i,e_i}$ also satisfies the second part of the claim of $(a),$ by considering seperately the cases of whether $j \in S(i),$ and $j \notin S(i)$.

If $j \in S(i)$ then, since $E_i \geq Q_j$, and $y_{i,e_i} \in H^0(\sx',e_iL'-E_i + Q_i)$,
\begin{align*}
	-\ord_{Q_j}(y_{i,e_i}) \leq e_i\subhalf {e_j'} - 1 \leq e_i \subhalf{e_j'} - \frac{1}{e_j'}.
\end{align*}

If instead $j \notin S(i)$, then since $e_j' \nmid e_i$, we know $e_i\subhalf{e_j'} \notin \BZ$, so
\begin{align*}
	-\ord_{Q_j}(y_{i,e_i}) \leq \lfloor  e_i\subhalf{e_j'} \rfloor \leq e_i\subhalf{e_j'} - \frac{1}{e_j'},
\end{align*}
completing the proof of (a).

Next, define $R_0 = R'$ and inductively define 
$$
R_i = \begin{cases}
	R_{i-1} &\text{ if }i \notin J\\
	R_{i-1}[y_{i,e_i}] &\text{ otherwise.} 
\end{cases}$$
To prove (b), it suffices to show that elements of the form $y_{i,e_i'}^ay_{i,e_i}^b$ with $a \geq 0, b > 0$ are linearly indpendent, and that these elements together with $R_{i-1}$ span $R_i$ as a $k$-vector space. These elements do not lie in $R_{i-1}$ because their order of pole at $Q_i$ is bigger than the order of any element in $R_{i-1}$, and are linearly independent amongst themselves because of injectivity of the linear map
\begin{align*}
	(a,b) \mapsto \left( \deg\left(y_{i,e_i'}^ay_{i,e_i}^b\right),-\ord_{Q_i}\left( y_{i,e_i'}^ay_{i,e_i}^b \right)  \right) = (a,b) \begin{pmatrix}
	e_i' & \subhalf{e_i'} \\
	e_i	 & \subhalf{e_i}
\end{pmatrix} 
\end{align*}


\end{proof}

\ssec{Base Cases}
\label{ssec:g_0_base}
Cases to induct on are here.

\ssec{Exceptional Cases}
\label{ssec:g_0_exceptional}
These are exceptional cases.

\ssec{Conclusion}
\label{ssec:g_0_conclusion}

\section{Genus positive}
We haven't done this.

\section{Acknowledgements}
We are grateful to VZB.

\nocite{*}
\bibliography{bibliography}{}
\bibliographystyle{plain}

\end{document}